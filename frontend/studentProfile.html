<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Profile</title>
    <link rel="icon" href="/img/profile.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/styles/studentProfile.css">
</head>
<body class="view-mode"> <!-- Default to View Mode -->

    <a href="javascript:history.back()" class="back-btn">
        <i class="fas fa-arrow-left"></i> Back
    </a>
    <div class="container">
        <h1>Student Profile</h1>
        
        <form id="profileForm" class="profile-grid">
            
            <!-- COLUMN 1: Basic Information -->
            <div class="col col-1">
                <div class="img-container">
                    <img src="/img/User.png" id="profilePicDisplay" alt="Profile Picture">
                    <label for="profilePicInput" class="upload-label">
                        <i class="fas fa-camera"></i> Change Photo
                    </label>
                    <input type="file" id="profilePicInput" name="profilePic" accept="image/*" style="display: none;">
                </div>

                <div class="info-group" style="width: 100%;">
                    <!-- Full Name -->
                    <div class="info-item">
                        <i class="fas fa-user"></i>
                        <span class="info-text" id="viewFullName">Loading...</span>
                        <input type="text" class="edit-input" id="editFullName" name="fullName" placeholder="Full Name">
                    </div>

                    <!-- Email -->
                    <div class="info-item">
                        <i class="fas fa-envelope"></i>
                        <span class="info-text" id="viewEmail">Loading...</span>
                        <input type="email" class="edit-input" id="editEmail" name="email" placeholder="Email" disabled title="Email cannot be changed">
                    </div>

                    <!-- Contact -->
                    <div class="info-item">
                        <i class="fas fa-phone"></i>
                        <span class="info-text" id="viewContact">Loading...</span>
                        <input type="tel" class="edit-input" id="editContact" name="contactNumber" placeholder="Mobile Number">
                    </div>
                    
                    <!-- Address -->
                    <div class="info-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span class="info-text" id="viewAddress">Loading...</span>
                        <input type="text" class="edit-input" id="editAddress" name="address" placeholder="Address">
                    </div>
                    
                    <!-- Gender -->
                    <div class="info-item">
                        <i class="fas fa-mars"></i>
                        <span class="info-text" id="viewGender">Loading...</span>
                         <select class="edit-input" id="editGender" name="gender">
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <!-- Password (Edit Only) -->
                     <input type="password" class="edit-input" id="editPassword" name="password" placeholder="Update Password (Optional)">

                </div>
            </div>

            <!-- COLUMN 2: Details & Socials -->
            <div class="col col-2">
                <h3>Academic & Personal</h3>
                
                <!-- Year -->
                <div class="info-item">
                    <i class="fas fa-graduation-cap"></i>
                    <span class="info-text" id="viewYear">Year</span>
                    <select class="edit-input" id="editYear" name="Year">
                        <option value="FE">First Year (FE)</option>
                        <option value="SE">Second Year (SE)</option>
                        <option value="TE">Third Year (TE)</option>
                        <option value="BE">Fourth Year (BE)</option>
                    </select>
                </div>

                <!-- Branch -->
                <div class="info-item">
                    <i class="fas fa-code-branch"></i>
                    <span class="info-text" id="viewBranch">Branch</span>
                    <select class="edit-input" id="editBranch" name="Branch">
                        <option value="CMPN">Computer Science</option>
                        <option value="INFT">IT</option>
                        <option value="EXTC">EXTC</option>
                        <option value="ELEC">Electrical</option>
                        <option value="ECS">Electronics & CS</option>
                    </select>
                </div>
                
                 <!-- About -->
                <div class="info-item">
                    <i class="fas fa-info-circle"></i>
                    <span class="info-text" id="viewAbout">About Me</span>
                    <textarea class="edit-input" id="editAbout" name="AboutYourself" rows="3" placeholder="Tell us about yourself"></textarea>
                </div>

                <h3>Social Links</h3>
                <div class="social-links">
                    <!-- GitHub -->
                    <div class="social-wrapper">
                        <a href="#" target="_blank" class="social-link social-view" id="linkGithub">
                            <i class="fab fa-github"></i> <span id="textGithub">GitHub</span>
                        </a>
                        <input type="url" class="edit-input" id="editGithub" name="github" placeholder="GitHub URL">
                    </div>
                    
                     <!-- LinkedIn -->
                    <div class="social-wrapper">
                        <a href="#" target="_blank" class="social-link social-view" id="linkLinkedin">
                            <i class="fab fa-linkedin"></i> <span id="textLinkedin">LinkedIn</span>
                        </a>
                        <input type="url" class="edit-input" id="editLinkedin" name="linkedin" placeholder="LinkedIn URL">
                    </div>

                     <!-- Instagram -->
                    <div class="social-wrapper">
                        <a href="#" target="_blank" class="social-link social-view" id="linkInstagram">
                            <i class="fab fa-instagram"></i> <span id="textInstagram">Instagram</span>
                        </a>
                        <input type="url" class="edit-input" id="editInstagram" name="instagram" placeholder="Instagram URL">
                    </div>
                    
                    <!-- Portfolio -->
                    <div class="social-wrapper">
                        <a href="#" target="_blank" class="social-link social-view" id="linkPortfolio">
                            <i class="fas fa-globe"></i> <span id="textPortfolio">Portfolio</span>
                        </a>
                        <input type="url" class="edit-input" id="editPortfolio" name="portfolio" placeholder="Portfolio URL">
                    </div>
                </div>
            </div>

            <!-- COLUMN 3: Preferences -->
            <div class="col col-3">
                <h3>Preferences</h3>
                
                <label class="edit-input-label" style="display:none;">Food Preference</label>
                <div class="info-item">
                    <i class="fas fa-utensils"></i>
                    <span class="info-text" id="viewFood">Loading...</span>
                    <select class="edit-input" id="editFood" name="foodType">
                        <option value="Veg">Veg</option>
                        <option value="Non-Veg">Non-Veg</option>
                        <option value="All">All types</option>
                    </select>
                </div>
                
                <label class="edit-input-label" style="display:none;">Room Type</label>
                <div class="info-item">
                    <i class="fas fa-bed"></i>
                    <span class="info-text" id="viewRoom">Loading...</span>
                    <div class="checkbox-container" id="editRoomContainer" style="display:none;">
                       <label><input type="checkbox" name="room_type" value="Single - 1 Member"> Single - 1 Member</label>
                       <label><input type="checkbox" name="room_type" value="Shared: 2 Members"> Shared: 2 Members</label>
                       <label><input type="checkbox" name="room_type" value="Apartment: 4 Members"> Apartment: 4 Members</label>
                       <label><input type="checkbox" name="room_type" value="1 RK: 1-2 Members"> 1 RK: 1-2 Members</label>
                       <label><input type="checkbox" name="room_type" value="2 RK: 2-4 Members"> 2 RK: 2-4 Members</label>
                       <label><input type="checkbox" name="room_type" value="1 BHK: 2 Members"> 1 BHK: 2 Members</label>
                       <label><input type="checkbox" name="room_type" value="2 BHK: 4 Members"> 2 BHK: 4 Members</label>
                    </div>
                </div>

                <label class="edit-input-label" style="display:none;">Budget</label>
                <div class="info-item">
                    <i class="fas fa-wallet"></i>
                     <span class="info-text" id="viewPricing">Loading...</span>
                     <select class="edit-input" id="editPricing" name="pricingValue">
                         <option value="Low: ₹5000 - 8000">Low: ₹5000 - 8000</option>
                         <option value="Medium: ₹8000 - 20000">Medium: ₹8000 - 20000</option>
                         <option value="High: ₹20000 - 30000">High: ₹20000 - 30000</option>
                     </select>
                </div>

                <h3>Room & Laundry Amenities Required</h3>
                <div id="viewAmenities" class="pref-grid social-view">
                    <!-- JS will populate icons here -->
                </div>
                
                <div class="checkbox-container edit-input" id="editAmenitiesContainer" style="display:none; border:none;">
                     <!-- Checkboxes for Amenities -->
                     <label><input type="checkbox" name="amenities" value="WiFi"> WiFi</label>
                     <label><input type="checkbox" name="amenities" value="Non-AC"> Non-AC</label>
                     <label><input type="checkbox" name="amenities" value="AC"> AC</label>
                     <label><input type="checkbox" name="amenities" value="TV"> TV</label>
                     <label><input type="checkbox" name="amenities" value="Furnished"> Furnished</label>
                     <label><input type="checkbox" name="amenities" value="Parking"> Parking</label>
                     <label><input type="checkbox" name="amenities" value="Wash & Iron"> Wash & Iron</label>
                     <label><input type="checkbox" name="amenities" value="Dry Cleaning"> Dry Cleaning</label>
                     <label><input type="checkbox" name="amenities" value="Pickup & Delivery"> Pickup & Delivery</label>
                     <label><input type="checkbox" name="amenities" value="Subscription Plans"> Subscription Plans</label>
                </div>

                <h3>Preferred Landmarks</h3>
                 <div id="viewLandmarks" class="pref-grid social-view">
                    <!-- JS will populate -->
                </div>
                <div class="checkbox-container edit-input" id="editLandmarkContainer" style="display:none; border:none;">
                     <label><input type="checkbox" name="landmark" value="Near Bus Station"> Near Bus Station</label>
                     <label><input type="checkbox" name="landmark" value="Near Railway Station"> Near Railway Station</label>
                     <label><input type="checkbox" name="landmark" value="Near Metro"> Near Metro</label>
                     <label><input type="checkbox" name="landmark" value="Near Market"> Near Market</label>
                     <label><input type="checkbox" name="landmark" value="Near College"> Near College</label>
                </div>

            </div>

            <!-- Action Buttons -->
            <div class="btn-container">
                <button type="button" class="btn btn-edit" onclick="toggleEditMode(true)">Edit Profile</button>
                <button type="button" class="btn btn-save" onclick="saveProfile()">Save Changes</button>
            </div>
        </form>
    </div>

    <script>
        try {
            window.initialUserData = JSON.parse('{{userData}}'.replace(/&quot;/g,'"'));
        } catch (e) {
            console.error("Error parsing userData from server:", e);
        }
    </script>

<!-- Success/Error Modal -->
<div id="statusModal" class="modal">
    <div class="success-modal-content">
        <div id="statusIcon" class="status-icon"></div>
        <h2 id="statusMessage"></h2>
        <button onclick="closeStatusModal()" class="modal-btn">OK</button>
    </div>
</div>

    <script src="/js/api.js"></script>
    <script src="js/studentProfile.js"></script>
</body>
</html>