<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flatmate - Service Provider Home</title>
    <link rel="icon" href="/img/home.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Calistoga&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Oleo+Script&family=Spicy+Rice&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
</head>
<body>

<div class="navbar">
    <div class="navbar-left">
        <h1>Flatmate</h1>
    </div>
    
    <button class="hamburger" id="hamburger-btn">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
    </button>

    <div class="navbar-center">
        <div class="search-container">
            <input type="text" class="search-box" id="search-input" placeholder="Search profiles and services...">
            <div class="search-icons-group">
                <button id="search-button" class="icon-link search icon">
                    <i class="fas fa-search"></i>
                </button>
                <button id="clear-button" class="icon-link clear icon">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>

    <div class="navbar-right" id="navbar-links">
        <button class="nav-link" onclick="showLogoutPopup()">Log out</button>
        <button class="nav-link" onclick="document.getElementById('services-food').scrollIntoView({ behavior: 'smooth' });">Services</button>
        
        <div class="navbar-icons">
            <button onclick="location.href='/serviceprofile'" class="icon-link profile-icon">
                <i class="fas fa-user fa-lg" style="color: #333;"></i>
            </button>
        </div>
    </div>
</div>

<!-- Logout Popup (Reusing Modal Class) -->
<div id="logoutPopup" class="modal">
    <div class="modal-content logout-modal-content">
        <p class="logout-title">Do you want to log out?</p>
        <div class="logout-actions">
            <button onclick="logout()" class="btn-logout btn-yes">Yes</button>
            <button onclick="closeLogoutPopup()" class="btn-logout btn-no">No</button>
        </div>
    </div>
</div>

<header id="header">
    <h1>Welcome to Flatmate</h1>
    <p>The perfect solution for the PG students and service providers.</p>
</header>

<section id="overview" class="how-it-works">
    <div class="content-container">
        <div class="text-content">
            <h2>How Flatmate Works</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('rent')">Quick Profile Publish</button>
                <button class="tab" onclick="showTab('find')">Showcase Your Services</button>
            </div>

            <div class="tab-content rent active">
                <ul class="checklist">
                    <li>
                        <span class="checkmark"> <i class="fas fa-check"></i></span>
                        Go to the Sign-Up page to create an account.
                    </li>
                    <li>
                        <span class="checkmark"> <i class="fas fa-check"></i></span>
                        Complete the form to make your profile visible on the site.
                    </li>
                    <li>
                        <span class="checkmark"> <i class="fas fa-check"></i></span>
                        Log in to update your profile on the homepage as needed.
                    </li>
                </ul>
            </div>

            <div class="tab-content find">
                <ul class="checklist">
                    <li>
                        <span class="checkmark"> <i class="fas fa-check"></i></span>
                        Complete the signup form.
                    </li>
                    <li>
                        <span class="checkmark"> <i class="fas fa-check"></i></span>
                        Choose a plan to publish your business.
                    </li>
                    <li>
                        <span class="checkmark"> <i class="fas fa-check"></i></span>
                        Your services will be available to customers upon registration.
                    </li>
                </ul>
            </div>
            <button class="get-started">Get Started</button>
        </div>

        <div class="image-content">
            <img src="/img/laptopuser.png" alt="Illustration of person working on a laptop">
        </div>
    </div>
</section>
    
<section id="about-us" class="about-section">
    <div class="grid-container">
        <!-- Left side (Image) -->
        <div class="image-section">
            <div class="flip-card" onclick="this.classList.toggle('flipped')">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <img src="/img/Aboutus.jpg" alt="About Us Image">
                    </div>
                    <div class="flip-card-back">
                         <i class="fas fa-play-circle" style="font-size: 50px; margin-bottom: 20px; color: #D0B8A8;"></i>
                        <p style="font-size: 20px; font-weight: 600;">Flatmate Features</p>
                        <small>(Video Coming Soon)</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right side (Description) -->
        <div class="description-section">
            <h2>Why Flatmate?</h2>
            <p>
                Welcome to our platform! We help students find 
                roommates and rooms easily. Our goal is to make 
                it simple for you to connect with your perfect flatmate 
                or find the right accommodation with just a few clicks. 
            </p>
            <p>
               We ensure that all listings are secure and 
               verified for your safety. Students can register 
               for free to search for roommates and rooms, while 
               service providers like PG owners and meal makers 
               can list their services at an affordable subscription fee. 
               Join us today and start your hassle-free journey to 
               finding your next home!
            </p>
            <button class="learn-more">Learn More</button>
        </div>
    </div>
</section>

<section id="profiles" class="section-header-container">
    <h1 class="section-header-title">Profiles</h1>
    <div class="swiper profilesSwiper container">
        <div class="swiper-wrapper content">
            <!-- Swiper Slides will be dynamically generated here -->
        </div>    
    <!-- Pagination and navigation inside container -->
    <div class="swiper-button-next profiles-next"></div>
    <div class="swiper-button-prev profiles-prev"></div>
    <div class="swiper-pagination profiles-pagination"></div>
    </div>
</section>

<!-- Removed Roommate Match and Service Providers Table sections as they are not present in original serviceHome.html -->

<section id="services-food" class="section-header-container">
    <h1 class="section-header-title">Services</h1>
    <h3>Food</h3>
    <div class="swiper foodSwiper container">
        <div class="swiper-wrapper content">
            <!-- Swiper Slides will be dynamically generated here -->
        </div>
        <div class="swiper-button-next food-next"></div>
        <div class="swiper-button-prev food-prev"></div>
        <div class="swiper-pagination food-pagination"></div>
    </div>
</section>

<section id="services-laundry" class="section-header-container">
    <h3>Laundry</h3>
    <div class="swiper laundrySwiper container">
        <div class="swiper-wrapper content">
            <!-- Swiper Slides will be dynamically generated here -->
        </div>
        <div class="swiper-button-next laundry-next"></div>
        <div class="swiper-button-prev laundry-prev"></div>
        <div class="swiper-pagination laundry-pagination"></div>
    </div>
</section>

<section id="services-brokers" class="section-header-container">
    <h3>Brokers</h3>
    <div class="swiper brokerSwiper container">
        <div class="swiper-wrapper content">
            <!-- Swiper Slides will be dynamically generated here -->
        </div>
        <div class="swiper-button-next broker-next"></div>
        <div class="swiper-button-prev broker-prev"></div>
        <div class="swiper-pagination broker-pagination"></div>
    </div>
</section>

<section id="footer-section">
    <footer>
        <div class="feet">
            <h1>Flatmate</h1>
            <p>
                Introducing our innovative platform designed to help
                students find the perfect roommates and accommodations. 
                Free registration for students ensures easy access,
                while PG owners, meal providers, and other service
                vendors can expand their reach with our subscription
                service. Built with plain HTML, CSS, JavaScript, Node.js,
                and MySQL, our website features advanced preference 
                matching algorithms along with search & filter options 
                for a seamless experience.
            </p>
            <div class="copyright">
                <p>&copy; 2024 Flatmate. All rights reserved.</p>
            </div>
        </div>
        <div class="feet2">
            <p>Quick links</p>
            <a href="#header">Home</a>
            <a href="#about-us">About Us</a>
            <a href="#profiles">Profiles</a>
            <a href="#services-food">Services</a>
            <a href="#overview">Overview</a>
            <a href="/teampage">Our Team</a>
        </div>
        <div class="contact">
            <p>Connect with us</p>
            <a href="" class="icon-link facebook"><i class="fab fa-facebook fa-lg"></i></a>
            <a href="" class="icon-link instagram"><i class="fab fa-instagram fa-lg"></i></a>
            <a href="" class="icon-link youtube"><i class="fab fa-youtube fa-lg"></i></a>
        </div>
    </footer>
    <button id="scrollTopBtn" class="scroll-top-btn">â¬†</button>
</section>

<!-- Include Swiper CSS & JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.js"></script>
<script>
    
// Global popup functions 
window.openPopup = function(button) {
    const popup = button.nextElementSibling;
    if (popup) {
        popup.classList.add("open-popup");
        popup.style.display = 'block';
    }
}

window.closePopup = function(button) {
    const popup = button.parentElement;
    if (popup) {
        popup.classList.remove("open-popup");
        popup.style.display = 'none';
    }
}

// search-input script for searching profiles and services
const searchBtn = document.getElementById('search-button');
if (searchBtn) {
    searchBtn.addEventListener('click', function () {
        const searchQuery = document.getElementById('search-input').value.toLowerCase();
        let firstMatchFound = false;

        const swiperSections = [
            {
                selector: '.profilesSwiper',
                filter: user => user.getAttribute('data-type') === 'profiles',
                scrollClass: '.profilesSwiper'
            },
            {
                selector: '.foodSwiper',
                filter: service => service.getAttribute('data-type') === 'Food',
                scrollClass: '.foodSwiper'
            },
            {
                selector: '.laundrySwiper',
                filter: service => service.getAttribute('data-type') === 'Laundry',
                scrollClass: '.laundrySwiper'
            },
            {
                selector: '.brokerSwiper',
                filter: service => service.getAttribute('data-type') === 'Broker',
                scrollClass: '.brokerSwiper'
            }
        ];

        swiperSections.forEach(section => {
            const swiperContainer = document.querySelector(section.selector);
            const slides = swiperContainer.querySelectorAll('.swiper-slide');

            if (searchQuery === '') {
                slides.forEach(slide => {
                    slide.style.display = 'flex'; 
                });
                if (swiperContainer.swiper) swiperContainer.swiper.update();
                return;
            }

            let hasMatch = false;

            slides.forEach(slide => {
                const name = slide.querySelector('.name')?.textContent.toLowerCase() || '';
                const type = slide.getAttribute('data-type')?.toLowerCase() || '';

                if (name.includes(searchQuery) || type.includes(searchQuery)) {
                    slide.style.display = 'flex';
                    hasMatch = true;
                } else {
                    slide.style.display = 'none';
                }
            });

            if (swiperContainer.swiper) swiperContainer.swiper.update();

            if (hasMatch && !firstMatchFound) {
                document.querySelector(section.scrollClass).scrollIntoView({ behavior: 'smooth' });
                firstMatchFound = true;
            }
        });
    });
}

const clearBtn = document.getElementById('clear-button');
if (clearBtn) {
    clearBtn.addEventListener('click', function () {
        document.getElementById('search-input').value = '';
        const swiperSections = [
            '.profilesSwiper',
            '.foodSwiper',
            '.laundrySwiper',
            '.brokerSwiper'
        ];

        swiperSections.forEach(selector => {
            const swiperContainer = document.querySelector(selector);
            const slides = swiperContainer.querySelectorAll('.swiper-slide');
            slides.forEach(slide => {
                slide.style.display = 'flex';
            });
            if (swiperContainer.swiper) swiperContainer.swiper.update();
        });
    });
}

// about-us section script
window.showTab = function(tab) {
    document.querySelectorAll('.tab').forEach(button => {
        button.classList.remove('active');
    });
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    const tabContent = document.querySelector(`.${tab}`);
    const tabButton = document.querySelector(`.tab[onclick="showTab('${tab}')"]`);
    if (tabContent) tabContent.classList.add('active');
    if (tabButton) tabButton.classList.add('active');
}

// Swiper Config
function getSwiperConfig() {
    return {
        slidesPerView: 1, 
        spaceBetween: 20,
        centeredSlides: false,
        grabCursor: true,
        loop: true,
        on: {
            slideChange: function () {
                const openPopups = document.querySelectorAll('.popup.open-popup');
                openPopups.forEach(popup => {
                    popup.classList.remove('open-popup');
                    popup.style.display = 'none';
                });
            }
        },
        slidesPerGroup: 1, 
        breakpoints: {
            768: { 
                slidesPerView: 2, 
                spaceBetween: 30,
                slidesPerGroup: 2, 
            },
            1024: { 
                slidesPerView: 3, 
                spaceBetween: 40,
                slidesPerGroup: 3, 
            },
            1440: { 
                slidesPerView: 3, 
                spaceBetween: 50,
                slidesPerGroup: 3, 
            }
        },
        pagination: {
            clickable: true,
            dynamicBullets: true,
            dynamicMainBullets: 3,
        },
    };
}

// Swiper Initialization
document.addEventListener('DOMContentLoaded', function () {
    fetch('/data')
        .then(response => response.json())
        .then(data => {
            // Profiles Swiper
            const profilesWrapper = document.querySelector('.profilesSwiper .swiper-wrapper');
            if (profilesWrapper) {
                data.profiles.forEach(user => {
                    const userSlide = document.createElement('div');
                    userSlide.classList.add('swiper-slide', 'card');
                    userSlide.setAttribute('data-type', 'profiles');
                    userSlide.innerHTML = `
                        <div class="card-content">
                            <div class="image">
                                <img src="${user.profile_pic}" alt="${user.full_name}'s pic" class="user-image">
                            </div>
                            <div class="name-profession">
                                <span class="name">${user.fULL_name}</span>
                                <span class="profession">${user.year} - ${user.branch}</span>
                            </div>
                            <button class="card-btn secondary" onclick="openPopup(this)">Contact Me</button>
                            <div class="popup">
                                <h5>Thank You for visiting My Profile!</h5>
                                <h5>Here are my contact details:</h5>
                                <ul class="popup-list">
                                    <li><i class="fas fa-phone"></i> ${user.contact_number}</li>
                                    <li><i class="fas fa-envelope"></i> ${user.email}</li>
                                </ul>
                                <div class="social-links" style="margin: 10px 0; display: flex; justify-content: center; gap: 10px;">
                                    ${user.github ? `<a href="${user.github}" target="_blank" title="GitHub" style="color: #333;"><i class="fab fa-github fa-lg"></i></a>` : ''}
                                    ${user.linkedin ? `<a href="${user.linkedin}" target="_blank" title="LinkedIn" style="color: #0077b5;"><i class="fab fa-linkedin fa-lg"></i></a>` : ''}
                                    ${user.instagram ? `<a href="${user.instagram}" target="_blank" title="Instagram" style="color: #E1306C;"><i class="fab fa-instagram fa-lg"></i></a>` : ''}
                                    ${user.portfolio ? `<a href="${user.portfolio}" target="_blank" title="Portfolio" style="color: #333;"><i class="fas fa-globe fa-lg"></i></a>` : ''}
                                </div>
                                <button type="button" onclick="closePopup(this)">OK</button>
                            </div>
                        </div>
                    `;
                    profilesWrapper.appendChild(userSlide);
                });
            }

            // Food Services Swiper
            const foodWrapper = document.querySelector('.foodSwiper .swiper-wrapper');
            if (foodWrapper) {
                const foodServices = data.services.filter(service => service.service === 'Food');
                foodServices.forEach(service => {
                    const serviceSlide = document.createElement('div');
                    serviceSlide.classList.add('swiper-slide', 'card');
                    serviceSlide.setAttribute('data-type', 'Food');
                    serviceSlide.innerHTML = `
                        <div class="card-content">
                            <div class="image">
                                <img src="/img/foodservice.jpg" alt="${service.business_Name} image" class="service-image">
                            </div>
                            <div class="name-profession">
                                <span class="name">${service.business_Name}</span>
                                <span class="profession">${service.service}</span>
                            </div>
                            <button class="card-btn secondary service-contact-btn" onclick="openPopup(this)">Contact Us</button>
                            <div class="popup" style="margin-top: 20px;">
                                <h5>Thank you for visiting our Service!</h5>
                                <h5 style="text-align: left;">Connect with us using the details:</h5>
                                <ul class="popup-list">
                                    <li><i class="fas fa-phone"></i> ${service.contact_number}</li>
                                    <li><i class="fas fa-envelope"></i> ${service.email}</li>
                                    <li onclick="window.location.href='${service.price_chart_link}';" style="cursor: pointer;"><i class="fas fa-file-invoice"></i> View Price Chart</li>
                                </ul>
                                <button type="button" style="background: #D0B8A8;" onclick="closePopup(this)">OK</button>
                            </div>
                        </div>
                    `;
                    foodWrapper.appendChild(serviceSlide);
                });
            }

            // Laundry Services Swiper
            const laundryWrapper = document.querySelector('.laundrySwiper .swiper-wrapper');
            if (laundryWrapper) {
                const laundryServices = data.services.filter(service => service.service === 'Laundry');
                laundryServices.forEach(service => {
                    const serviceSlide = document.createElement('div');
                    serviceSlide.classList.add('swiper-slide', 'card');
                    serviceSlide.setAttribute('data-type', 'Laundry');
                    serviceSlide.innerHTML = `
                        <div class="card-content">
                            <div class="image">
                                <img src="/img/laundryservice.jpg" alt="${service.business_Name} image" class="service-image">
                            </div>
                            <div class="name-profession">
                                <span class="name">${service.business_Name}</span>
                                <span class="profession">${service.service}</span>
                            </div>
                            <button class="card-btn secondary service-contact-btn" onclick="openPopup(this)">Contact Us</button>
                            <div class="popup" style="margin-top: 20px;">
                                <h5>Thank you for visiting our Service!</h5>
                                <h5 style="text-align: left;">Connect with us using the details:</h5>
                                <ul class="popup-list">
                                    <li><i class="fas fa-phone"></i> ${service.contact_number}</li>
                                    <li><i class="fas fa-envelope"></i> ${service.email}</li>
                                    <li onclick="window.location.href='${service.price_chart_link}';" style="cursor: pointer;"><i class="fas fa-file-invoice"></i> View Price Chart</li>
                                </ul>
                                <button type="button" style="background: #D0B8A8;" onclick="closePopup(this)">OK</button>
                            </div>
                        </div>
                    `;
                    laundryWrapper.appendChild(serviceSlide);
                });
            }

            // Broker Services Swiper
            const brokerWrapper = document.querySelector('.brokerSwiper .swiper-wrapper');
            if (brokerWrapper) {
                const brokerServices = data.services.filter(service => service.service === 'Broker');
                brokerServices.forEach(service => {
                    const serviceSlide = document.createElement('div');
                    serviceSlide.classList.add('swiper-slide', 'card');
                    serviceSlide.setAttribute('data-type', 'Broker');
                    serviceSlide.innerHTML = `
                        <div class="card-content">
                            <div class="image">
                                <img src="/img/brokerservice.jpg" alt="${service.business_Name} image" class="service-image">
                            </div>
                            <div class="name-profession">
                                <span class="name">${service.business_Name}</span>
                                <span class="profession">${service.service}</span>
                            </div>
                            <button class="card-btn secondary service-contact-btn" onclick="openPopup(this)">Contact Us</button>
                            <div class="popup" style="margin-top: 20px;">
                                <h5>Thank you for visiting our Service!</h5>
                                <h5 style="text-align: left;">Connect with us using the details:</h5>
                                <ul class="popup-list">
                                    <li><i class="fas fa-phone"></i> ${service.contact_number}</li>
                                    <li><i class="fas fa-envelope"></i> ${service.email}</li>
                                    <li onclick="window.location.href='${service.price_chart_link}';" style="cursor: pointer;"><i class="fas fa-file-invoice"></i> View Price Chart</li>
                                </ul>
                                <button type="button" style="background: #D0B8A8;" onclick="closePopup(this)">OK</button>
                            </div>
                        </div>
                    `;
                    brokerWrapper.appendChild(serviceSlide);
                });
            }

            const commonConfig = getSwiperConfig();

            // Initialize Swipers
            new Swiper(".profilesSwiper", {
                ...commonConfig,
                pagination: { ...commonConfig.pagination, el: ".profiles-pagination" },
                navigation: { nextEl: ".profiles-next", prevEl: ".profiles-prev" },
            });

            new Swiper(".foodSwiper", {
                ...commonConfig,
                pagination: { ...commonConfig.pagination, el: ".food-pagination" },
                navigation: { nextEl: ".food-next", prevEl: ".food-prev" },
            });

            new Swiper(".laundrySwiper", {
                ...commonConfig,
                pagination: { ...commonConfig.pagination, el: ".laundry-pagination" },
                navigation: { nextEl: ".laundry-next", prevEl: ".laundry-prev" },
            });

            new Swiper(".brokerSwiper", {
                ...commonConfig,
                pagination: { ...commonConfig.pagination, el: ".broker-pagination" },
                navigation: { nextEl: ".broker-next", prevEl: ".broker-prev" },
            });
        })
        .catch(error => console.error('Error fetching data:', error));
});

// logout popup script
function showLogoutPopup() {
    const popup = document.getElementById('logoutPopup');
    if (popup) popup.style.display = 'block';
}

function logout() {
    window.location.href = '/';
}

function closeLogoutPopup() {
    const popup = document.getElementById('logoutPopup');
    if (popup) popup.style.display = 'none';
}

// Hamburger Toggle
document.addEventListener('DOMContentLoaded', () => {
    const hamburger = document.getElementById('hamburger-btn');
    const navbarRight = document.getElementById('navbar-links');
    
    if (hamburger && navbarRight) {
        hamburger.addEventListener('click', () => {
            navbarRight.classList.toggle('active');
            
            const lines = hamburger.querySelectorAll('.hamburger-line');
            if (navbarRight.classList.contains('active')) {
                 lines[0].style.transform = 'rotate(45deg) translate(5px, 6px)';
                 lines[1].style.opacity = '0';
                 lines[2].style.transform = 'rotate(-45deg) translate(5px, -6px)';
            } else {
                 lines[0].style.transform = 'none';
                 lines[1].style.opacity = '1';
                 lines[2].style.transform = 'none';
            }
        });
    }
});

// srcoll to top button script 
document.addEventListener('DOMContentLoaded', () => {
        const scrollBtn = document.getElementById('scrollTopBtn');

        if (scrollBtn) {
            window.onscroll = function () {
                if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                    scrollBtn.style.display = 'flex'; // Changed to flex to match style.css
                } else {
                    scrollBtn.style.display = 'none';
                }
            };

            scrollBtn.onclick = function () {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
        }

        const scrollLinks = document.querySelectorAll('a[href^="#"]:not([href="#"])');

        scrollLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);

                if (targetElement) {
                    const offset = 130;
                    window.scrollTo({
                        top: targetElement.offsetTop - offset,
                        behavior: 'smooth'
                    });
                }
            });
        });
    });
</script>

</body>
</html>
